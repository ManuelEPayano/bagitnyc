<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <!--Edit the title of the page-->
    <title>#BagitNYC Map</title>
    <meta name="description" content="">
    <meta name="author" content="">
<!--
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
-->
    <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.css" />
    <!--[if lte IE 8]>
      <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.ie.css" />
    <![endif]-->
    <!--Switch between the different themes changing the stylesheet below - light-theme.css |dark-theme.css -->
    <script src="https://maps.googleapis.com/maps/api/js?sensor=false&v=3.8"></script>
    <script src="http://libs.cartocdn.com/cartodb.js/v3/cartodb.js"></script>
<!--    <link rel="stylesheet" href="css/light-theme.css">-->
    <link rel="stylesheet" href="css/makeitresponsive.css">
    <link rel="stylesheet" href="css/light-theme.css">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Amatic+SC">
      <script type="text/javascript" src="instafeed.js/instafeed.min.js"></script>
  </head>
  <body>
<div class="map" id="map">
        <script>
      function initialize() {
        cartodb.createVis('map', 'http://jossphilippe.cartodb.com/api/v2/viz/4dedce04-91da-11e3-ada5-0e49973114de/viz.json', {
            shareable: true,
            title: false,
            description: false,
            search: true,
            tiles_loader: true,
            center_lat: 40.711346,
            center_lon: -73.947826,
            zoom: 11
        })
      }
            
            $.getJSON("http://jossphilippe.cartodb.com/api/v2/sql?q=SELECT%20count(*)%20FROM%20instagram_media", function (data) {
                // Get the 'items' from the first group.
               
                var items = data.rows[0];
               
                // Find the last index and the last item.
                var count = items.count;
              //  alert(count);
                $("#count").prepend(count);
                console.log("Text: " + items.count);
            });
            
            
      window.onload = initialize;
    </script>

</div>
<div class="sidepanel">
    <div class="wrapper">
        <div class="context subheader">
          <h1>#BagitNYC</h1>
        </div>
        <p><a id="count"></a>Instagrams of plastic bag litter across NYC Council Districts</p>
          

   
<!--                <H2>TEST INSTASCROLL</H2>-->
        
                <div id="instafeed" style="height: 200px;">
                    <script type="text/javascript">
    var feed = new Instafeed({
        get: 'tagged',
        tagName: 'bagitnyc',
        clientId: 'edf88a2a6fa94c9889e9800db8317f68',
        limit: 40,
        sortBy: 'most-liked',
        after: function () {
   var images = $("#instafeed").find('a');
    $.each(images, function(index, image) {
      var delay = (index * 75) + 'ms';
      $(image).css('-webkit-animation-delay', delay);
      $(image).css('-moz-animation-delay', delay);
      $(image).css('-ms-animation-delay', delay);
      $(image).css('-o-animation-delay', delay);
      $(image).css('animation-delay', delay);
      $(image).addClass('animated flipInX');
    });
  },
  template: '<a href="{{link}}" target="_blank"><img src="{{image}}" /><div class="likes">&hearts; {{likes}}</div></a>'
});
feed.run();
</script>
                </div>
            </div>

      </div>


  </body>
</html>
